<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>

    <meta charset="utf-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>

    <!--Description-->

    

    
        <meta name="description" content="Accuracy and Error Based MetricsMean Absolute Error (MAE)Given a movie rating dataset[2], it calculates the average absolute difference between predic"/>
    

    <!--Author-->
    
        <meta name="author" content="Sen Wang"/>
    

    <!--Open Graph Title-->
    
        <meta property="og:title" content="Recommendation System Evaluation"/>
    

    <!--Open Graph Description-->
    
        <meta property="og:description" content="Accuracy and Error Based MetricsMean Absolute Error (MAE)Given a movie rating dataset[2], it calculates the average absolute difference between predic"/>
    

    <!--Open Graph Site Name-->
        <meta property="og:site_name" content="The Walden"/>

    <!--Type page-->
    
        <meta property="og:type" content="article"/>
    

    <!--Page Cover-->
    
    
        <meta property="og:image" content="http://www.senwang.meimg/lake_tahoe_2023_unsplash.jpg"/>
    

        <meta name="twitter:card" content="summary_large_image"/>

    

    
        <meta name="twitter:image" content="http://www.senwang.meimg/lake_tahoe_2023_unsplash.jpg"/>
    

    <!-- Title -->
    
    <title>Recommendation System Evaluation - The Walden</title>

    <!-- Bootstrap Core CSS -->
    <link href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Custom CSS -->
    
<link rel="stylesheet" href="/css/style.css">


    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
    <link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Gallery -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.css" type="text/css" rel="stylesheet"/>

    <!-- Google Analytics -->
    
    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'G-PN9Y5ELMMM', 'auto');
        ga('send', 'pageview');

    </script>



    <!-- favicon -->
    

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head>


<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">The Walden</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                
                    <li>
                        <a href="/">
                            
                                Home
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/archives">
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/tags">
                            
                                Tags
                            
                        </a>
                    </li>
                
                    <li>
                        <a href="/categories">
                            
                                Categories
                            
                        </a>
                    </li>
                
                    <li>
                        <a target="_blank" rel="noopener" href="https://github.com/senwang86">
                            
                                <i class="fa fa-github fa-stack-2x"></i>
                            
                        </a>
                    </li>
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/lake_tahoe_2023_unsplash.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Recommendation System Evaluation</h1>
                    
                    <span class="meta">
                        <!-- Date and Author -->
                        
                        
                            2023-10-03
                        
                    </span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

            <!-- Tags and categories -->
           
                <div class="col-lg-5 col-lg-offset-1 col-md-5 col-md-offset-1 post-tags">
                    
                        


<a href="/tags/metric/">#metric</a>


                    
                </div>
                <div class="col-lg-5 col-md-5 post-categories">
                    
                        

<a href="/categories/ML-Applications/">ML Applications</a>

                    
                </div>
            

            <!-- Gallery -->
            

            <!-- Post Main Content -->
            <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1">
                <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><h1 id=""><a href="#" class="headerlink" title=""></a></h1><h2 id="Accuracy-and-Error-Based-Metrics"><a href="#Accuracy-and-Error-Based-Metrics" class="headerlink" title="Accuracy and Error Based Metrics"></a>Accuracy and Error Based Metrics</h2><h3 id="Mean-Absolute-Error-MAE"><a href="#Mean-Absolute-Error-MAE" class="headerlink" title="Mean Absolute Error (MAE)"></a>Mean Absolute Error (MAE)</h3><p>Given a movie rating dataset<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[An Exhaustive List of Methods to Evaluate Recommender Systems](https://towardsdatascience.com/an-exhaustive-list-of-methods-to-evaluate-recommender-systems-a70c05e121de)">[2]</span></a></sup>, it calculates the average absolute difference between predicted and actual ratings.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mean_absolute_error</span>(<span class="params">actual_ratings, predicted_ratings</span>):</span><br><span class="line">    <span class="comment"># Check if the lengths of actual_ratings and predicted_ratings are equal</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(actual_ratings) != <span class="built_in">len</span>(predicted_ratings):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;The length of actual_ratings and predicted_ratings must be the same.&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    n = <span class="built_in">len</span>(actual_ratings)</span><br><span class="line">    total_error = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Iterate through the lists and calculate the absolute difference between actual and predicted ratings</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        total_error += <span class="built_in">abs</span>(actual_ratings[i] - predicted_ratings[i])</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate the average of absolute differences</span></span><br><span class="line">    mae = total_error / n</span><br><span class="line">    <span class="keyword">return</span> mae</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">actual_ratings = [<span class="number">3.5</span>, <span class="number">4.0</span>, <span class="number">2.0</span>, <span class="number">5.0</span>, <span class="number">3.0</span>]</span><br><span class="line">predicted_ratings = [<span class="number">3.0</span>, <span class="number">4.5</span>, <span class="number">1.5</span>, <span class="number">4.5</span>, <span class="number">2.5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Call the mean_absolute_error function with actual_ratings and predicted_ratings</span></span><br><span class="line">mae = mean_absolute_error(actual_ratings, predicted_ratings)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Mean Absolute Error: <span class="subst">&#123;mae&#125;</span>&quot;</span>) <span class="comment"># 0.5</span></span><br></pre></td></tr></table></figure>

<h3 id="Root-Mean-Square-Error-RMSE"><a href="#Root-Mean-Square-Error-RMSE" class="headerlink" title="Root Mean Square Error (RMSE)"></a>Root Mean Square Error (RMSE)</h3><p>Mean Square Error (MSE) calculates the average squared differences between predicted and actual ratings, which helps to negate the negative sign but it scales up the errors that cannot be compared to actual rating values due to different rating scales.</p>
<p>In RMSE, it takes the square root of MSE to normalize the scale issue that MSE had.  </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">root_mean_square_error</span>(<span class="params">actual_ratings, predicted_ratings</span>):</span><br><span class="line">    <span class="comment"># Check if the lengths of actual_ratings and predicted_ratings are equal</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(actual_ratings) != <span class="built_in">len</span>(predicted_ratings):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;The length of actual_ratings and predicted_ratings must be the same.&quot;</span>)</span><br><span class="line">        </span><br><span class="line">    n = <span class="built_in">len</span>(actual_ratings)</span><br><span class="line">    total_error = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Iterate through the lists and calculate the squared difference between actual and predicted ratings</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        total_error += (actual_ratings[i] - predicted_ratings[i]) ** <span class="number">2</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate the square root of the average of squared differences</span></span><br><span class="line">    rmse = math.sqrt(total_error / n)</span><br><span class="line">    <span class="keyword">return</span> rmse</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">actual_ratings = [<span class="number">3.5</span>, <span class="number">4.0</span>, <span class="number">2.0</span>, <span class="number">5.0</span>, <span class="number">3.0</span>]</span><br><span class="line">predicted_ratings = [<span class="number">3.0</span>, <span class="number">4.5</span>, <span class="number">1.5</span>, <span class="number">4.5</span>, <span class="number">2.5</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Call the root_mean_square_error function with actual_ratings and predicted_ratings</span></span><br><span class="line">rmse = root_mean_square_error(actual_ratings, predicted_ratings)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Root Mean Square Error: <span class="subst">&#123;rmse&#125;</span>&quot;</span>) <span class="comment"># 0.5</span></span><br></pre></td></tr></table></figure>

<h3 id="Precision-Precision-K"><a href="#Precision-Precision-K" class="headerlink" title="Precision, Precision@K"></a>Precision, Precision@K</h3><p>It measures the proportion of relevant recommendations out of all the recommended items, the formula<sup id="fnref:5"><a href="#fn:5" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Ranking Evaluation Metrics for Recommender Systems](https://towardsdatascience.com/ranking-evaluation-metrics-for-recommender-systems-263d0a66ef54)">[5]</span></a></sup> is:</p>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>precision</mtext><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∣</mi><mo stretchy="false">{</mo><mtext>relevant documents</mtext><mo stretchy="false">}</mo><mo>∩</mo><mo stretchy="false">{</mo><mtext>retrieved documents</mtext><mo stretchy="false">}</mo><mi mathvariant="normal">∣</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mo stretchy="false">{</mo><mtext>retrieved documents</mtext><mo stretchy="false">}</mo><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{precision} = \frac{|\{\text{relevant documents}\} \cap \{\text{retrieved documents}\}|}{|\{\text{retrieved documents}\}|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8623000000000001em;vertical-align:-0.19444em;"></span><span class="mord text"><span class="mord">precision</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mopen mtight">{</span><span class="mord text mtight"><span class="mord mtight">retrieved documents</span></span><span class="mclose mtight">}</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mopen mtight">{</span><span class="mord text mtight"><span class="mord mtight">relevant documents</span></span><span class="mclose mtight">}</span><span class="mbin mtight">∩</span><span class="mopen mtight">{</span><span class="mord text mtight"><span class="mord mtight">retrieved documents</span></span><span class="mclose mtight">}</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>

<p>Precision@K<sup id="fnref:4"><a href="#fn:4" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[MRR vs MAP vs NDCG: Ranking-Aware Evaluation Metrics And When to Use Them](https://medium.com/swlh/rank-aware-recsys-evaluation-metrics-5191bba16832)">[4]</span></a></sup> is outfitted with a top-K bound, in the scenario that users are not willing to exhaustively browse all the recommended items and only have a short bandwidth for the top-K items; in this case, the recommendation list is hard capped to top-K items only.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">precision</span>(<span class="params">recommended_items, relevant_items</span>):</span><br><span class="line">    <span class="comment"># Calculate the intersection of recommended_items and relevant_items</span></span><br><span class="line">    true_positive = <span class="built_in">len</span>(<span class="built_in">set</span>(recommended_items).intersection(<span class="built_in">set</span>(relevant_items)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the total number of recommended items</span></span><br><span class="line">    total_recommended_items = <span class="built_in">len</span>(recommended_items)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate precision</span></span><br><span class="line">    precision_value = true_positive / total_recommended_items <span class="keyword">if</span> total_recommended_items &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> precision_value</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">recommended_item_ids = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line">relevant_item_ids = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">precision_value = precision(recommended_item_ids, relevant_item_ids)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Precision: <span class="subst">&#123;precision_value:<span class="number">.2</span>f&#125;</span>&quot;</span>) <span class="comment"># 0.6</span></span><br></pre></td></tr></table></figure>

<h3 id="Recall-Recall-K"><a href="#Recall-Recall-K" class="headerlink" title="Recall, Recall@K"></a>Recall, Recall@K</h3><p>It measures the proportion of relevant recommendations out of all the relevant items, the formula<sup id="fnref:5"><a href="#fn:5" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Ranking Evaluation Metrics for Recommender Systems](https://towardsdatascience.com/ranking-evaluation-metrics-for-recommender-systems-263d0a66ef54)">[5]</span></a></sup> is:</p>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>recall</mtext><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∣</mi><mo stretchy="false">{</mo><mtext>relevant documents</mtext><mo stretchy="false">}</mo><mo>∩</mo><mo stretchy="false">{</mo><mtext>retrieved documents</mtext><mo stretchy="false">}</mo><mi mathvariant="normal">∣</mi></mrow><mrow><mi mathvariant="normal">∣</mi><mo stretchy="false">{</mo><mtext>relevant documents</mtext><mo stretchy="false">}</mo><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{recall} = \frac{|\{\text{relevant documents}\} \cap \{\text{retrieved documents}\}|}{|\{\text{relevant documents}\}|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord text"><span class="mord">recall</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.53em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.01em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mopen mtight">{</span><span class="mord text mtight"><span class="mord mtight">relevant documents</span></span><span class="mclose mtight">}</span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.485em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mopen mtight">{</span><span class="mord text mtight"><span class="mord mtight">relevant documents</span></span><span class="mclose mtight">}</span><span class="mbin mtight">∩</span><span class="mopen mtight">{</span><span class="mord text mtight"><span class="mord mtight">retrieved documents</span></span><span class="mclose mtight">}</span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">recall</span>(<span class="params">recommended_items, relevant_items</span>):</span><br><span class="line">    <span class="comment"># Calculate the intersection of recommended_items and relevant_items</span></span><br><span class="line">    true_positive = <span class="built_in">len</span>(<span class="built_in">set</span>(recommended_items).intersection(<span class="built_in">set</span>(relevant_items)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the total number of relevant items</span></span><br><span class="line">    total_relevant_items = <span class="built_in">len</span>(relevant_items)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate recall</span></span><br><span class="line">    recall_value = true_positive / total_relevant_items <span class="keyword">if</span> total_relevant_items &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> recall_value</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">recommended_item_ids = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line">relevant_item_ids = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">15</span>, <span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">recall_value = recall(recommended_item_ids, relevant_item_ids)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Recall: <span class="subst">&#123;recall_value:<span class="number">.2</span>f&#125;</span>&quot;</span>) <span class="comment"># 0.43</span></span><br></pre></td></tr></table></figure>

<h3 id="Precision-Recall-Curve-3"><a href="#Precision-Recall-Curve-3" class="headerlink" title="Precision-Recall Curve [3]"></a>Precision-Recall Curve <sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Why You Should Stop Using the ROC Curve](https://towardsdatascience.com/why-you-should-stop-using-the-roc-curve-a46a9adc728)">[3]</span></a></sup></h3><h3 id="ROC-Curve-3"><a href="#ROC-Curve-3" class="headerlink" title="ROC Curve [3]"></a>ROC Curve <sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Why You Should Stop Using the ROC Curve](https://towardsdatascience.com/why-you-should-stop-using-the-roc-curve-a46a9adc728)">[3]</span></a></sup></h3><h2 id="Ranking-Metrics-Quality-Over-Quantity"><a href="#Ranking-Metrics-Quality-Over-Quantity" class="headerlink" title="Ranking Metrics: Quality Over Quantity"></a>Ranking Metrics: Quality Over Quantity</h2><p>Accuracy-based metrics allow us to understand the overall performance of the results we get from the recommendation systems. But they provide no information on how the items were ordered. A model can have a good RMSE score but if the top three items that it recommends are not relevant to the user then the recommendation is not much useful. Ranking metrics assess the quality of the ranking of recommended items, ensuring that the most relevant items appear at the top of the list.</p>
<h3 id="Mean-Reciprocal-Rank-MRR"><a href="#Mean-Reciprocal-Rank-MRR" class="headerlink" title="Mean Reciprocal Rank (MRR)"></a>Mean Reciprocal Rank (MRR)</h3><p>It calculates the average of the reciprocal ranks of the first relevant recommendation for each user.</p>
<ul>
<li>Pros<ul>
<li>Position-aware: MRR takes into account the position of the first relevant item in the recommendation list, rewarding systems that rank relevant items higher. For example, MRR of a list with the first relevant item at its 3rd position will be greater than for a list with the first relevant item at 4th position.</li>
<li>Average performance: MRR calculates the mean reciprocal rank across all users, providing an overall measure of the recommendation system’s performance.</li>
<li>Intuitive interpretation: MRR scores range from 0 to 1, with higher values indicating better performance.</li>
</ul>
</li>
<li>Cons<ul>
<li>Limited scope: MRR focuses exclusively on the first relevant item in the list and does not evaluate the rest of the list of recommended items. This can be a limitation in scenarios where multiple relevant items or the overall ranking quality are important.</li>
<li>Binary relevance assumption: MRR assumes a binary relevance scale (either relevant or not relevant) and does not account for varying degrees of relevance on a continuous scale. This can be a limitation in situations where the relevance of items is not binary and needs to be quantified more granularly.</li>
<li>Lack of personalization: While MRR provides an average performance measure across all users, it may not fully capture the personalized aspect of recommendation systems. A high MRR score does not necessarily guarantee that the recommendation system is providing good recommendations for each individual user.</li>
<li>Sensitivity to outliers: MRR can be sensitive to outliers, as it calculates the reciprocal rank of the first relevant item for each user. A few users with very low reciprocal ranks can significantly impact the overall MRR score, potentially making it less reliable for evaluating the general performance of a recommendation system.</li>
</ul>
</li>
</ul>
<p><img src="/2023/10/03/Recommendation-System-Evaluation/mean_reciprocal_rank.png" alt="Mean Reciprocal Rank" title="https://medium.com/swlh/rank-aware-recsys-evaluation-metrics-5191bba16832"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">mean_reciprocal_rank</span>(<span class="params">recommended_items_list, relevant_items_list</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(recommended_items_list) != <span class="built_in">len</span>(relevant_items_list):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;The length of recommended_items_list and relevant_items_list must be the same.&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    reciprocal_ranks = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Iterate through the lists of recommended items and relevant items for each user</span></span><br><span class="line">    <span class="keyword">for</span> recommended_items, relevant_items <span class="keyword">in</span> <span class="built_in">zip</span>(recommended_items_list, relevant_items_list):</span><br><span class="line">        <span class="comment"># Find the reciprocal rank for each user</span></span><br><span class="line">        <span class="keyword">for</span> rank, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(recommended_items, start=<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> item <span class="keyword">in</span> relevant_items:</span><br><span class="line">                reciprocal_ranks.append(<span class="number">1</span> / rank)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            reciprocal_ranks.append(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the mean reciprocal rank</span></span><br><span class="line">    mrr = <span class="built_in">sum</span>(reciprocal_ranks) / <span class="built_in">len</span>(reciprocal_ranks)</span><br><span class="line">    <span class="keyword">return</span> mrr</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">recommended_items_list = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>], <span class="comment"># user 1</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>], <span class="comment"># user 2</span></span><br><span class="line">    [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>] <span class="comment"># user 3</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">relevant_items_list = [</span><br><span class="line">    [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>], <span class="comment"># user 1</span></span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>], <span class="comment"># user 2</span></span><br><span class="line">    [<span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>] <span class="comment"># user 3</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">mrr = mean_reciprocal_rank(recommended_items_list, relevant_items_list)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Mean Reciprocal Rank: <span class="subst">&#123;mrr:<span class="number">.2</span>f&#125;</span>&quot;</span>) <span class="comment"># 0.39</span></span><br></pre></td></tr></table></figure>

<h3 id="Mean-Average-Precision-MAP"><a href="#Mean-Average-Precision-MAP" class="headerlink" title="Mean Average Precision (MAP)"></a>Mean Average Precision (MAP)</h3><p>Similar to MRR, it calculates the average precision for each user and takes the mean across all users. It takes into account both the order and the relevance of recommended items. The larger value is, the better the recommendation quality is.</p>
<ul>
<li>Pros<ul>
<li>Position-aware: MAP takes into account the position of relevant items in the recommendation list, rewarding systems that rank relevant items higher.</li>
<li>Relevance-aware: MAP considers the relevance of items by calculating the average precision for each user, which is the average of the precision scores at each relevant item’s position. </li>
<li>Average performance: MAP calculates the mean average precision across all users, providing an overall measure of the recommendation system’s performance.</li>
<li>Robustness: MAP is less sensitive to outliers compared to some other metrics, as it calculates the average precision across multiple positions in the recommendation list for each user.</li>
</ul>
</li>
<li>Cons<ul>
<li>Binary relevance assumption, e.g., on a scale from 1 to 5 stars, the evaluation would need first to threshold the ratings to make binary relevancies. One option is to consider only ratings bigger than 4 as relevant. This introduces bias in the evaluation metric because of the manual threshold<sup id="fnref:4"><a href="#fn:4" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[MRR vs MAP vs NDCG: Ranking-Aware Evaluation Metrics And When to Use Them](https://medium.com/swlh/rank-aware-recsys-evaluation-metrics-5191bba16832)">[4]</span></a></sup>.</li>
<li>Lack of personalization</li>
<li>Not suitable for all scenarios: MAP is more appropriate for recommendation scenarios where a ranked list of items is provided to users. It may not be suitable for other types of recommendation scenarios, such as collaborative filtering or content-based recommendations that do not involve explicit ranking.</li>
</ul>
</li>
</ul>
<p><img src="/2023/10/03/Recommendation-System-Evaluation/mean_average_precision.png" alt="Mean Average Precision" title="https://medium.com/swlh/rank-aware-recsys-evaluation-metrics-5191bba16832"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">average_precision</span>(<span class="params">recommended_items, relevant_items</span>):</span><br><span class="line">    true_positives = <span class="number">0</span></span><br><span class="line">    sum_precisions = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> rank, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(recommended_items, start=<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> item <span class="keyword">in</span> relevant_items:</span><br><span class="line">            true_positives += <span class="number">1</span></span><br><span class="line">            precision_at_rank = true_positives / rank</span><br><span class="line">            sum_precisions += precision_at_rank</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> sum_precisions / <span class="built_in">len</span>(relevant_items) <span class="keyword">if</span> <span class="built_in">len</span>(relevant_items) &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">mean_average_precision</span>(<span class="params">recommended_items_list, relevant_items_list</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(recommended_items_list) != <span class="built_in">len</span>(relevant_items_list):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&quot;The length of recommended_items_list and relevant_items_list must be the same.&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    average_precisions = []</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the average precision for each user</span></span><br><span class="line">    <span class="keyword">for</span> recommended_items, relevant_items <span class="keyword">in</span> <span class="built_in">zip</span>(recommended_items_list, relevant_items_list):</span><br><span class="line">        ap = average_precision(recommended_items, relevant_items)</span><br><span class="line">        average_precisions.append(ap)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the mean average precision across all users</span></span><br><span class="line">    map_value = <span class="built_in">sum</span>(average_precisions) / <span class="built_in">len</span>(average_precisions)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">round</span>(map_value, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">recommended_items_list = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>],</span><br><span class="line">    [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">relevant_items_list = [</span><br><span class="line">    [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">map_value = mean_average_precision(recommended_items_list, relevant_items_list)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Mean Average Precision: <span class="subst">&#123;map_value&#125;</span>&quot;</span>) <span class="comment"># 0.29</span></span><br></pre></td></tr></table></figure>

<h3 id="Normalized-Discounted-Cumulative-Gain-nDCG"><a href="#Normalized-Discounted-Cumulative-Gain-nDCG" class="headerlink" title="Normalized Discounted Cumulative Gain (nDCG)"></a>Normalized Discounted Cumulative Gain (nDCG)</h3><p>Given the fact that most relevant items are more useful than irrelevant items, nDCG evaluates the ranking quality by assigning higher importance to relevant items appearing at the top of the recommendation list. It is normalized to ensure comparability across different users and queries.</p>
<ul>
<li><p>Cumulative Gains (CG): It sums the items based on its relevancy, hence, the term cumulative. For example, if we score the relevance,  most relevant score &#x3D;&gt; 2, somewhat relevant score &#x3D;&gt; 1, least relevant score &#x3D;&gt; 0. </p>
</li>
<li><p>Discounted Cumulative Gains (DCG): It penalized the items that appear lower in the list. A relevant item appearing at the end of the list is a result of a bad recommender system and hence that item should be discounted. To do so we divide the relevance score of items with the log of its rank on the list.</p>
</li>
<li><p>Normalized Discounted Cumulative Gains (nDCG): nDCG normalized the DCG values of the different number of the items lists. To do so we sort the item list by relevancy and calculate the DCG for that list. This will be the perfect DCG score as items are sorted by their relevancy score. We divide all DCG score of all the list we get by this perfect DCG to get the normalized score for that list.</p>
</li>
<li><p>Pros</p>
<ul>
<li>Position-aware: Items that are ranked higher (closer to the top) contribute more to the nDCG score, reflecting the fact that users are more likely to interact with items at the top of the list.</li>
<li>Relevance-weighted: nDCG incorporates the relevance of each recommended item, allowing it to differentiate between items with varying degrees of relevance. This makes it suitable for situations where the relevance of items is not binary (e.g., partially relevant, highly relevant) and can be quantified on a continuous scale.</li>
<li>Normalized: nDCG is normalized against the ideal ranking, which means it can be compared across different queries or users.</li>
<li>Suitable for diverse recommendation scenarios: nDCG is applicable to various recommendation scenarios, including search engine result ranking, collaborative filtering, and content-based recommendation.</li>
<li>Intuitive interpretation: nDCG scores range from 0 to 1, with higher values indicating better ranking quality.</li>
</ul>
</li>
<li><p>Cons</p>
<ul>
<li>Lack of personalization</li>
<li>Binary relevance assumption: Although nDCG can handle varying degrees of relevance, it is often used with binary relevance judgments in practice. </li>
<li>Sensitive to the choice of the ideal ranking: The normalization factor in nDCG is based on the ideal ranking, which can sometimes be subjective or difficult to determine. The choice of the ideal ranking can influence the nDCG score, potentially affecting its consistency and reliability.</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">discounted_cumulative_gain</span>(<span class="params">recommended_items, relevant_items</span>):</span><br><span class="line">    dcg = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(recommended_items, start=<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> item <span class="keyword">in</span> relevant_items:</span><br><span class="line">            dcg += <span class="number">1</span> / (math.log2(i + <span class="number">1</span>))</span><br><span class="line">    <span class="keyword">return</span> dcg</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ideal_discounted_cumulative_gain</span>(<span class="params">recommended_items, relevant_items</span>):</span><br><span class="line">    sorted_relevant_items = <span class="built_in">sorted</span>(relevant_items, key=<span class="keyword">lambda</span> x: recommended_items.index(x) <span class="keyword">if</span> x <span class="keyword">in</span> recommended_items <span class="keyword">else</span> <span class="built_in">float</span>(<span class="string">&#x27;inf&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> discounted_cumulative_gain(sorted_relevant_items, relevant_items)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">normalized_discounted_cumulative_gain</span>(<span class="params">recommended_items, relevant_items</span>):</span><br><span class="line">    dcg = discounted_cumulative_gain(recommended_items, relevant_items)</span><br><span class="line">    idcg = ideal_discounted_cumulative_gain(recommended_items, relevant_items)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> idcg == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">round</span>(dcg / idcg, <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">recommended_items_list = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>],</span><br><span class="line">    [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">relevant_items_list = [</span><br><span class="line">    [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>],</span><br><span class="line">    [<span class="number">16</span>, <span class="number">17</span>, <span class="number">18</span>, <span class="number">19</span>, <span class="number">20</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">ndcg_values = [normalized_discounted_cumulative_gain(recommended, relevant)</span><br><span class="line">               <span class="keyword">for</span> recommended, relevant <span class="keyword">in</span> <span class="built_in">zip</span>(recommended_items_list, relevant_items_list)]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;nDCG values: <span class="subst">&#123;ndcg_values&#125;</span>&quot;</span>) <span class="comment"># [0.53, 0.53, 0.23]</span></span><br></pre></td></tr></table></figure>

<h3 id="Spearman-Rank-Correlation-Evaluation-2-12"><a href="#Spearman-Rank-Correlation-Evaluation-2-12" class="headerlink" title="Spearman Rank Correlation Evaluation [2] [12]"></a>Spearman Rank Correlation Evaluation <sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[An Exhaustive List of Methods to Evaluate Recommender Systems](https://towardsdatascience.com/an-exhaustive-list-of-methods-to-evaluate-recommender-systems-a70c05e121de)">[2]</span></a></sup> <sup id="fnref:12"><a href="#fn:12" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Metrics of Recommender Systems: An Overview](https://towardsdatascience.com/metrics-of-recommender-systems-cde64042127a)">[12]</span></a></sup></h3><h3 id="Pearson-Correlation-12-14"><a href="#Pearson-Correlation-12-14" class="headerlink" title="Pearson Correlation [12] [14]"></a>Pearson Correlation <sup id="fnref:12"><a href="#fn:12" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Metrics of Recommender Systems: An Overview](https://towardsdatascience.com/metrics-of-recommender-systems-cde64042127a)">[12]</span></a></sup> <sup id="fnref:14"><a href="#fn:14" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[A Book Recommendation System](https://prianjali98.medium.com/a-book-recommendation-system-c2089b2fd3ce)">[14]</span></a></sup></h3><h3 id="Rank-Biased-Precision-RBP-15"><a href="#Rank-Biased-Precision-RBP-15" class="headerlink" title="Rank-Biased Precision (RBP) [15]"></a>Rank-Biased Precision (RBP) <sup id="fnref:15"><a href="#fn:15" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Comprehensive Guide to Ranking Evaluation Metrics](https://towardsdatascience.com/comprehensive-guide-to-ranking-evaluation-metrics-7d10382c1025)">[15]</span></a></sup></h3><h3 id="Expected-Reciprocal-Rank-ERR-15"><a href="#Expected-Reciprocal-Rank-ERR-15" class="headerlink" title="Expected Reciprocal Rank (ERR) [15]"></a>Expected Reciprocal Rank (ERR) <sup id="fnref:15"><a href="#fn:15" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Comprehensive Guide to Ranking Evaluation Metrics](https://towardsdatascience.com/comprehensive-guide-to-ranking-evaluation-metrics-7d10382c1025)">[15]</span></a></sup></h3><h2 id="Coverage-and-Diversity-Metrics"><a href="#Coverage-and-Diversity-Metrics" class="headerlink" title="Coverage and Diversity Metrics"></a>Coverage and Diversity Metrics</h2><h3 id="Catalog-Coverage"><a href="#Catalog-Coverage" class="headerlink" title="Catalog Coverage"></a>Catalog Coverage</h3><p>It measures the proportion of items in the catalog that are recommended at least once.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">catalog_coverage</span>(<span class="params">recommended_items_list, catalog_items</span>):</span><br><span class="line">    <span class="comment"># Flatten the list of recommended items and convert it to a set</span></span><br><span class="line">    unique_recommended_items = <span class="built_in">set</span>(item <span class="keyword">for</span> sublist <span class="keyword">in</span> recommended_items_list <span class="keyword">for</span> item <span class="keyword">in</span> sublist)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate the intersection of unique recommended items and catalog items</span></span><br><span class="line">    covered_items = unique_recommended_items.intersection(catalog_items)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate the catalog coverage</span></span><br><span class="line">    coverage = <span class="built_in">len</span>(covered_items) / <span class="built_in">len</span>(catalog_items)</span><br><span class="line">    <span class="keyword">return</span> coverage</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">recommended_items_list = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>], <span class="comment"># user 1</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>], <span class="comment"># user 2</span></span><br><span class="line">    [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>] <span class="comment"># user 3</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">catalog_items = <span class="built_in">set</span>(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">21</span>))</span><br><span class="line"></span><br><span class="line">coverage = catalog_coverage(recommended_items_list, catalog_items)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Catalog Coverage: <span class="subst">&#123;coverage&#125;</span>&quot;</span>) <span class="comment"># 0.8</span></span><br></pre></td></tr></table></figure>

<h3 id="Prediction-Coverage"><a href="#Prediction-Coverage" class="headerlink" title="Prediction Coverage"></a>Prediction Coverage</h3><p>It measures the proportion of possible user-item pairs for which the recommendation system can make predictions.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">prediction_coverage</span>(<span class="params">predicted_ratings, total_users, total_items</span>):</span><br><span class="line">    <span class="comment"># Count the number of user-item pairs for which the recommendation system can make predictions</span></span><br><span class="line">    predicted_pairs = <span class="built_in">sum</span>(<span class="built_in">len</span>(ratings) <span class="keyword">for</span> ratings <span class="keyword">in</span> predicted_ratings)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the total number of possible user-item pairs</span></span><br><span class="line">    total_possible_pairs = total_users * total_items</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the prediction coverage</span></span><br><span class="line">    coverage = predicted_pairs / total_possible_pairs</span><br><span class="line">    <span class="keyword">return</span> coverage</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">predicted_ratings = [</span><br><span class="line">    &#123;<span class="number">1</span>: <span class="number">3.5</span>, <span class="number">3</span>: <span class="number">4.0</span>, <span class="number">5</span>: <span class="number">2.5</span>, <span class="number">7</span>: <span class="number">3.0</span>, <span class="number">9</span>: <span class="number">4.5</span>&#125;, <span class="comment"># user 1, item 1 has the predicted rating of 3.5, item 9 has the predicted rating of 4.5.</span></span><br><span class="line">    &#123;<span class="number">2</span>: <span class="number">4.5</span>, <span class="number">4</span>: <span class="number">3.0</span>, <span class="number">6</span>: <span class="number">2.0</span>, <span class="number">8</span>: <span class="number">3.5</span>&#125;, <span class="comment"># user 2</span></span><br><span class="line">    &#123;<span class="number">11</span>: <span class="number">3.5</span>, <span class="number">12</span>: <span class="number">4.0</span>, <span class="number">13</span>: <span class="number">2.5</span>, <span class="number">14</span>: <span class="number">3.0</span>, <span class="number">15</span>: <span class="number">4.5</span>, <span class="number">16</span>: <span class="number">3.5</span>, <span class="number">17</span>: <span class="number">2.0</span>&#125; <span class="comment"># user 3</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">total_users = <span class="number">3</span></span><br><span class="line">total_items = <span class="number">20</span></span><br><span class="line"></span><br><span class="line">coverage = prediction_coverage(predicted_ratings, total_users, total_items)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Prediction Coverage: <span class="subst">&#123;coverage:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="Diversity"><a href="#Diversity" class="headerlink" title="Diversity"></a>Diversity</h3><p>It helps ensure personalized and engaging experiences for users, supports exploration, reduces filter bubbles, promotes long-tail items, and enhances the robustness of the system.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics.pairwise <span class="keyword">import</span> cosine_similarity</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">diversity</span>(<span class="params">recommended_items_list, item_features</span>):</span><br><span class="line">    total_similarity = <span class="number">0</span></span><br><span class="line">    total_pairs = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> recommended_items <span class="keyword">in</span> recommended_items_list:</span><br><span class="line">        <span class="comment"># Calculate pairwise cosine similarities for the recommended items</span></span><br><span class="line">        similarities = cosine_similarity([item_features[item] <span class="keyword">for</span> item <span class="keyword">in</span> recommended_items])</span><br><span class="line">        <span class="comment"># Sum the similarities for all item pairs</span></span><br><span class="line">        total_similarity += np.<span class="built_in">sum</span>(similarities) - np.trace(similarities)  <span class="comment"># Exclude the diagonal</span></span><br><span class="line">        <span class="comment"># Count the total number of item pairs</span></span><br><span class="line">        total_pairs += <span class="built_in">len</span>(recommended_items) * (<span class="built_in">len</span>(recommended_items) - <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the average similarity between item pairs</span></span><br><span class="line">    avg_similarity = total_similarity / total_pairs <span class="keyword">if</span> total_pairs &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">    <span class="comment"># Calculate the diversity by subtracting the average similarity from 1</span></span><br><span class="line">    diversity = <span class="number">1</span> - avg_similarity</span><br><span class="line">    <span class="keyword">return</span> diversity</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">recommended_items_list = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>], <span class="comment"># user 1</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>], <span class="comment"># user 2</span></span><br><span class="line">    [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>] <span class="comment"># user 3</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example item features dictionary (using 5-dimension random feature vector)</span></span><br><span class="line">item_features = &#123;item: np.random.rand(<span class="number">5</span>) <span class="keyword">for</span> item <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">21</span>)&#125;</span><br><span class="line"></span><br><span class="line">diversity_value = diversity(recommended_items_list, item_features)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Diversity: <span class="subst">&#123;diversity_value:<span class="number">.2</span>f&#125;</span>&quot;</span>) <span class="comment"># 0.23</span></span><br></pre></td></tr></table></figure>

<h3 id="Serendipity"><a href="#Serendipity" class="headerlink" title="Serendipity"></a>Serendipity</h3><p>It measures the degree to which the recommended items are both relevant and unexpected, promoting the discovery of novel and interesting items. A recommendation list with serendipity can introduce users to items they may not have expected to enjoy or find relevant, leading to serendipitous discoveries. This can create a more enjoyable and engaging user experience.</p>
<p>Measuring serendipity is a challenging task as it involves the combination of relevance, surprise, and novelty. Here’s a Python function to calculate a basic version of Serendipity, which measures the degree to which the recommended items are both relevant and unexpected:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">serendipity</span>(<span class="params">recommended_items_list, relevant_items_list, popular_items, k=<span class="number">10</span></span>):</span><br><span class="line">    serendipity_score = <span class="number">0</span></span><br><span class="line">    total_users = <span class="built_in">len</span>(recommended_items_list)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> recommended_items, relevant_items <span class="keyword">in</span> <span class="built_in">zip</span>(recommended_items_list, relevant_items_list):</span><br><span class="line">        <span class="comment"># Select the top-k recommended items</span></span><br><span class="line">        top_k_recommended = recommended_items[:k]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Find the serendipitous items by removing popular items from relevant items</span></span><br><span class="line">        serendipitous_items = <span class="built_in">set</span>(relevant_items) - <span class="built_in">set</span>(popular_items)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Count the number of serendipitous items in the top-k recommendations</span></span><br><span class="line">        serendipitous_recommendations = <span class="built_in">len</span>(<span class="built_in">set</span>(top_k_recommended) &amp; serendipitous_items)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># Calculate the proportion of serendipitous items in the top-k recommendations</span></span><br><span class="line">        serendipity_score += serendipitous_recommendations / k</span><br><span class="line"></span><br><span class="line">    <span class="comment"># Calculate the average serendipity score across all users</span></span><br><span class="line">    avg_serendipity = serendipity_score / total_users</span><br><span class="line">    <span class="keyword">return</span> avg_serendipity</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example usage</span></span><br><span class="line">recommended_items_list = [</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">11</span>], <span class="comment"># user 1</span></span><br><span class="line">    [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">12</span>], <span class="comment"># user 2</span></span><br><span class="line">    [<span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">16</span>, <span class="number">17</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>] <span class="comment"># user 3</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">relevant_items_list = [</span><br><span class="line">    [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">17</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">14</span>, <span class="number">16</span>],</span><br><span class="line">    [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">11</span>, <span class="number">12</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">17</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">popular_items = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line"></span><br><span class="line">serendipity_value = serendipity(recommended_items_list, relevant_items_list, popular_items)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Serendipity: <span class="subst">&#123;serendipity_value:<span class="number">.2</span>f&#125;</span>&quot;</span>) <span class="comment"># 0.20</span></span><br></pre></td></tr></table></figure>

<h3 id="Popularity-2"><a href="#Popularity-2" class="headerlink" title="Popularity[2]"></a>Popularity<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[An Exhaustive List of Methods to Evaluate Recommender Systems](https://towardsdatascience.com/an-exhaustive-list-of-methods-to-evaluate-recommender-systems-a70c05e121de)">[2]</span></a></sup></h3><h3 id="Novelty-2"><a href="#Novelty-2" class="headerlink" title="Novelty[2]"></a>Novelty<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[An Exhaustive List of Methods to Evaluate Recommender Systems](https://towardsdatascience.com/an-exhaustive-list-of-methods-to-evaluate-recommender-systems-a70c05e121de)">[2]</span></a></sup></h3><h3 id="Hit-Ratio-HR-5"><a href="#Hit-Ratio-HR-5" class="headerlink" title="Hit Ratio (HR)[5]"></a>Hit Ratio (HR)<sup id="fnref:5"><a href="#fn:5" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Ranking Evaluation Metrics for Recommender Systems](https://towardsdatascience.com/ranking-evaluation-metrics-for-recommender-systems-263d0a66ef54)">[5]</span></a></sup></h3><p>It is the fraction of users for which the relevant item is included in the recommendation list of length K.</p>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>HR</mtext><mo>=</mo><mfrac><mrow><mi mathvariant="normal">∣</mi><msubsup><mi>U</mi><mrow><mi>h</mi><mi>i</mi><mi>t</mi></mrow><mi>K</mi></msubsup><mi mathvariant="normal">∣</mi></mrow><mrow><mi mathvariant="normal">∣</mi><msub><mi>U</mi><mrow><mi>a</mi><mi>l</mi><mi>l</mi></mrow></msub><mi mathvariant="normal">∣</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\text{HR} = \frac{|U^K_{hit}|}{|U_{all}|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord text"><span class="mord">HR</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.673565em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.153565em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.3487714285714287em;margin-left:-0.10903em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15122857142857138em;"><span></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.5102em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∣</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">U</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9190928571428572em;"><span style="top:-2.214em;margin-left:-0.10903em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">h</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">K</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span><span class="mord mtight">∣</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>

<p>|U<sup>K</sup><sub>hit</sub>| is the number of users for which the relevant item is included in the top K recommended items ||U<sub>all</sub>| | is the total number of users in the test dataset.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><div id="footnotes"><hr><div id="footnotelist"><ol style="list-style: none; padding-left: 0; margin-left: 40px"><li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://medium.com/grabngoinfo/the-ultimate-guide-to-evaluating-your-recommendation-system-d4fc8d4423cc">The Ultimate Guide to Evaluating Your Recommendation System</a><a href="#fnref:1" rev="footnote"> ↩</a></span></li><li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://towardsdatascience.com/an-exhaustive-list-of-methods-to-evaluate-recommender-systems-a70c05e121de">An Exhaustive List of Methods to Evaluate Recommender Systems</a><a href="#fnref:2" rev="footnote"> ↩</a></span></li><li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">3.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://towardsdatascience.com/why-you-should-stop-using-the-roc-curve-a46a9adc728">Why You Should Stop Using the ROC Curve</a><a href="#fnref:3" rev="footnote"> ↩</a></span></li><li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">4.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://medium.com/swlh/rank-aware-recsys-evaluation-metrics-5191bba16832">MRR vs MAP vs NDCG: Ranking-Aware Evaluation Metrics And When to Use Them</a><a href="#fnref:4" rev="footnote"> ↩</a></span></li><li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">5.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://towardsdatascience.com/ranking-evaluation-metrics-for-recommender-systems-263d0a66ef54">Ranking Evaluation Metrics for Recommender Systems</a><a href="#fnref:5" rev="footnote"> ↩</a></span></li><li id="fn:6"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">6.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://towardsdatascience.com/evaluating-a-real-life-recommender-system-error-based-and-ranking-based-84708e3285b">Evaluating A Real-Life Recommender System, Error-Based and Ranking-Based</a><a href="#fnref:6" rev="footnote"> ↩</a></span></li><li id="fn:7"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">7.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">Paper <a target="_blank" rel="noopener" href="https://www.researchgate.net/publication/215470714_Evaluating_collaborative_filtering_recommender_systems">Evaluating Collaborative Filtering Recommender Systems</a><a href="#fnref:7" rev="footnote"> ↩</a></span></li><li id="fn:8"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">8.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;">Paper <a target="_blank" rel="noopener" href="https://tzin.bgu.ac.il/~shanigu/Publications/JMLRSurvey.pdf">A Survey of Accuracy Evaluation Metrics of Recommendation Tools</a><a href="#fnref:8" rev="footnote"> ↩</a></span></li><li id="fn:9"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">9.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://medium.com/@readsumant/understanding-ndcg-as-a-metric-for-your-recomendation-system-5cd012fb3397">Understanding NDCG as a Metric for your Recommendation System</a><a href="#fnref:9" rev="footnote"> ↩</a></span></li><li id="fn:10"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">10.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://biarnes-adrien.medium.com/a-complete-tutorial-on-off-policy-evaluation-for-recommender-systems-e92085018afe">A Complete Tutorial On Off-Policy Evaluation for Recommendation Systems</a><a href="#fnref:10" rev="footnote"> ↩</a></span></li><li id="fn:11"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">11.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://medium.com/qloo/popular-evaluation-metrics-in-recommender-systems-explained-324ff2fb427d">Popular Evaluation Metrics in Recommender Systems Explained</a><a href="#fnref:11" rev="footnote"> ↩</a></span></li><li id="fn:12"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">12.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://towardsdatascience.com/metrics-of-recommender-systems-cde64042127a">Metrics of Recommender Systems: An Overview</a><a href="#fnref:12" rev="footnote"> ↩</a></span></li><li id="fn:14"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">14.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://prianjali98.medium.com/a-book-recommendation-system-c2089b2fd3ce">A Book Recommendation System</a><a href="#fnref:14" rev="footnote"> ↩</a></span></li><li id="fn:15"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">15.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://towardsdatascience.com/comprehensive-guide-to-ranking-evaluation-metrics-7d10382c1025">Comprehensive Guide to Ranking Evaluation Metrics</a><a href="#fnref:15" rev="footnote"> ↩</a></span></li></ol></div></div>

                
            </div>

            <!-- Comments -->
            
                <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1">
                    


                </div>
            
        </div>
    </div>
</article>

    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    

                    
                        <li>
                            <a href="https://www.facebook.com/swang6891" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.instagram.com/senwang86" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-instagram fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://github.com/senwang86" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                        <li>
                            <a href="https://www.linkedin.com/in/sen-wang-283aa437/" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                </ul>
                <p class="copyright text-muted">&copy; 2023 Sen Wang<br></p>
                <p class="copyright text-muted">Original Theme <a target="_blank" href="http://startbootstrap.com/template-overviews/clean-blog/">Clean Blog</a> from <a href="http://startbootstrap.com/" target="_blank">Start Bootstrap</a></p>
                
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    
<!-- jQuery -->
<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>

<!-- Bootstrap -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

<!-- Gallery -->
<script src="//cdnjs.cloudflare.com/ajax/libs/featherlight/1.3.5/featherlight.min.js" type="text/javascript" charset="utf-8"></script>

<!-- Disqus Comments -->



</body>

</html>